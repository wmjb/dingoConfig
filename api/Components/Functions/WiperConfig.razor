@using domain.Devices.dingoPdm.Functions
@using domain.Devices.dingoPdm.Enums

<MudCard Outlined="true" Class="mb-2">
    <MudCardContent>
        <MudGrid>
            <MudItem xs="12" md="6">
                <MudTextField @bind-Value="Wiper.Name"
                              Label="Name"
                              Variant="Variant.Outlined" />
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSwitch @bind-Value="Wiper.Enabled"
                           Label="Enabled"
                           Color="Color.Primary" />
            </MudItem>

            <MudItem xs="12">
                <MudText Typo="Typo.h6" Class="mt-2">Mode & General Settings</MudText>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.Mode"
                           Label="Wiper Mode"
                           Variant="Variant.Outlined">
                    @foreach (WiperMode mode in Enum.GetValues(typeof(WiperMode)))
                    {
                        <MudSelectItem Value="@mode">@mode</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSwitch @bind-Value="Wiper.ParkStopLevel"
                           Label="Park Stop Level"
                           Color="Color.Primary" />
            </MudItem>
            <MudItem xs="12" md="6">
                <MudNumericField @bind-Value="Wiper.WashWipeCycles"
                                 Label="Wash Wipe Cycles"
                                 Variant="Variant.Outlined"
                                 Min="0"
                                 Max="15" />
            </MudItem>

            <MudItem xs="12">
                <MudText Typo="Typo.h6" Class="mt-2">Input Mappings</MudText>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.SlowInput"
                           Label="Slow Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.FastInput"
                           Label="Fast Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.InterInput"
                           Label="Intermittent Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.OnInput"
                           Label="ON Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.SpeedInput"
                           Label="Speed Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.ParkInput"
                           Label="Park Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.SwipeInput"
                           Label="Swipe Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudSelect @bind-Value="Wiper.WashInput"
                           Label="Wash Input"
                           Variant="Variant.Outlined"
                           T="VarMap">
                    @foreach (VarMap varMap in Enum.GetValues(typeof(VarMap)))
                    {
                        <MudSelectItem Value="@varMap">@varMap</MudSelectItem>
                    }
                </MudSelect>
            </MudItem>

            <MudItem xs="12">
                <MudText Typo="Typo.h6" Class="mt-2">Speed Map</MudText>
            </MudItem>
            @for (int i = 0; i < 8; i++)
            {
                var index = i; // Capture for lambda
                <MudItem xs="6" md="3">
                    <MudSelect @bind-Value="Wiper.SpeedMap[index]"
                               Label="@($"Speed {index}")"
                               Variant="Variant.Outlined">
                        @foreach (WiperSpeed speed in Enum.GetValues(typeof(WiperSpeed)))
                        {
                            <MudSelectItem Value="@speed">@speed</MudSelectItem>
                        }
                    </MudSelect>
                </MudItem>
            }

            <MudItem xs="12">
                <MudText Typo="Typo.h6" Class="mt-2">Intermittent Delays (seconds)</MudText>
            </MudItem>
            @for (int i = 0; i < 6; i++)
            {
                var index = i; // Capture for lambda
                <MudItem xs="6" md="4">
                    <MudNumericField @bind-Value="Wiper.IntermitTime[index]"
                                     Label="@($"Delay {index}")"
                                     Variant="Variant.Outlined"
                                     Min="0"
                                     Step="0.1" />
                </MudItem>
            }
        </MudGrid>
    </MudCardContent>
</MudCard>

@code {
    [Parameter, EditorRequired]
    public Wiper Wiper { get; set; } = null!;
}
